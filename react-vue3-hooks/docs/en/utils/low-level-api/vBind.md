# vBind

vBind corresponds to the `v-bind` directive in Vue 3, which is used for dynamically binding HTML attributes or component props.

It unifies Vue's three binding syntaxes into React's props object spread pattern, generating executable attribute binding expressions during compilation.

## Core Features

**Unified handling of static and dynamic keys**: The compiler compiles both `:key="value"` and `:[key]="value"` into `vBind(key, value)` calls, eliminating the need to distinguish whether the key name is a variable. The compilation of dynamic key names is handled by the compiler during the code generation phase.

**Object syntax spreading**: Supports the object syntax of `v-bind="{ id: foo, className: bar }"`, directly spreading into a props object, which is consistent with the semantics of the JSX spread operator.

**Side-effect-free pure function**: vBind is a pure function that only calculates output based on input, without relying on any runtime state, allowing for inline optimization during the compilation phase.

## Usage Methods

### 1. Static Key Binding

Compiling the `:className="inputClass"` expression:

```jsx
import { vBind } from 'react-vue3-hooks';

function MyComponent() {
  const inputClass = 'form-input';
  
  return <div {...vBind('className', inputClass)} />;
  // Output: <div className="form-input" />
}
```

### 2. Dynamic Key Binding (Variable as Key)

Compiling the `:[attrName]="value"` expression, where `attrName` is a runtime variable:

```jsx
function MyComponent() {
  const attrName = 'data-id';
  const value = '123';
  
  return <div {...vBind(attrName, value)} />;
  // Output: <div data-id="123" />
}
```

### 3. Batch Binding with Object Syntax

Compiling the `v-bind="{ id, disabled }"` expression:

```jsx
function MyComponent() {
  const id = 'submit-btn';
  const disabled = true;
  
  return <button {...vBind({ id, disabled, 'data-test': 'primary' })} />;
  // Output: <button id="submit-btn" disabled data-test="primary" />
}
```

### 4. Combining with Computed Properties

Binding a computed set of dynamic properties:

```jsx
function Card({ user }) {
  const userProps = useMemo(() => ({
    'data-user-id': user.id,
    'data-role': user.role,
    className: user.isActive ? 'active' : 'inactive',
  }), [user]);
  
  return <div {...vBind(userProps)} />;
}
```

## Difference from Vue

| Feature | Vue v-bind | vBind |
|---------|------------|-------|
| **Execution Timing** | Dynamically bound at runtime | Calculates props during component rendering |
| **Syntactic Sugar** | Supports `:key` and `:[key]` shorthand | Only function calls, generated by the compiler |
| **Object Spreading** | `v-bind="{...}"` automatically spreads | `vBind(obj)` returns a spreadable object |
| **Modifiers** | `.prop`, `.attr`, etc. | Handled in the runtime library (e.g., vBindProp) |
| **HTML Attributes** | Automatically distinguishes between HTML and DOM attributes | Distinguished by the React JSX runtime |

**Core Difference**: Vue's v-bind dynamically binds through the template engine at runtime and supports modifiers like `.prop` and `.attr`; vBind is a compile-time utility function that generates pure JavaScript expressions, with the final attribute binding handled by the React JSX runtime.

## Compiler Code Generation Example

```tsx
// Vue template
<input :class="inputClass" :[dynamicAttr]="value" v-bind="{ disabled, readonly }" />

// Compiled React code
function InputComponent() {
  const dynamicAttr = 'data-id';
  return (
    <input 
      {...vBind('className', inputClass), 
       ...vBind(dynamicAttr, value), 
       ...vBind({ disabled, readonly })}
    />
  );
}
```

## Notes

**Avoid inline object creation**: Do not directly create objects inline in JSX, as this will generate new references on each render, leading to unnecessary re-renders:

```jsx
// ❌ Wrong: Creates a new object on each render
<div {...vBind({ id: 'test', className: 'box' })} />

// ✅ Correct: Use useMemo or extract outside the component
const staticProps = useMemo(() => ({ id: 'test', className: 'box' }), []);
<div {...vBind(staticProps)} />
```

**Type safety for dynamic keys**: Ensure that dynamic key names are serializable strings at compile time. If key names come from untrusted inputs, validation should be performed during the compilation phase.

**Relationship with native spread operator**: The object returned by vBind can be directly used for JSX spreading without additional conversion. In performance-sensitive scenarios, consider compiler inline optimization into direct object literals.

**Attribute override order**: Multiple vBind calls are spread in order, with later attributes overriding earlier ones with the same name, consistent with Vue templates where the rightmost attribute takes precedence.
